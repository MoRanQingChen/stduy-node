<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<style>
</style>
<body>
<table>
	<thead>
		<th>姓名</th>
		<th>年龄</th>
		<th>学号</th>
		<th>成绩</th>
	</thead>
	<tbody>

	</tbody>
</table>
<script type="text/javascript">
	var xhr=new XMLHttpRequest();
	var arr=[];
	xhr.open("get","http://127.0.0.1:8090/data.txt",false);
	xhr.onreadystatechange=function() {
		console.log(xhr.readyState,xhr.status)
		if (xhr.readyState === 4 && /^2\d{2}$/.test(xhr.status)) {
        	 arr = eval(xhr.responseText);
        	 console.dir(arr)
    	}
	};
	xhr.send(null);

	var frg=document.createDocumentFragment();
	for (var i = 0; i < arr.length; i++) {
		var oTr=document.createElement("tr");
		oTr.innerHTML="<td>"+arr[i].name+"</td><td>"+arr[i].age+"</td><td>"+arr[i].num+"</td><td>"+arr[i].score+"</td>"
		 frg.appendChild(oTr);
	}
	console.dir(frg)

	var oTh=document.getElementsByTagName("th");
	var oTbody=document.getElementsByTagName("tbody")[0];
	oTbody.appendChild(frg);
	var rows=oTbody.getElementsByTagName("tr");
	var flag=[];
	rows=Array.prototype.slice.call(rows);
	for (var j = 0; j < oTh.length; j++) {
		flag.push(-1);
		oTh[j].onclick=(function(j){
			return function(){
				for (var i = 0; i < oTh.length; i++) {
					i==j||(flag[i]=-1);
				}
				flag[j]*=-1;
				rows.sort(function(a,b){
					if(isNaN(a.cells[j].innerHTML)){
						return flag[j]*(a.cells[j].innerHTML.localeCompare(b.cells[j].innerHTML))
					}else{
						return flag[j]*(a.cells[j].innerHTML-b.cells[j].innerHTML)
					}
				})
				for (var i = 0; i < rows.length; i++) {
					oTbody.appendChild(rows[i]);
				}	
			}
		})(j)
	}
</script>
</body>
</html>